var MongoClient = require('mongodb').MongoClient;
var assert = require('assert');
var ObjectId = require('mongodb').ObjectID;
var url = 'mongodb://localhost:27017/members';
var getnews = function(method, data, callback){
	MongoClient.connect(url, function(err, db){
		if (method == 'create') {
			db.collection('member').insertOne({
				'name' : data[0].name,
				'time_added' : Date(),
				'gender' : data[0].gender,
				'age' : data[0].age,
				'tel' : data[0].tel
			});
			var members = db.collection('member').find().sort({name:1});
			members.toArray(function(err, docs){
				assert.equal(err, null);
				callback(docs);
			});
			console.log(data);

		}else if (method == 'read') {
			var members = db.collection('member').find().sort({name:1});
			members.toArray(function(err, docs) {
				    assert.equal(err, null);
				    console.log("Found the following records");
				    //console.dir(docs);
				    //res.status(200).render('newspost', {newspost:docs, title:'New Posts'});
				    callback(docs);
			 });
		};
	});
}

module.exports = getnews;